/*!
 * infiDate-js - Modern Infinite Scroll DatePicker Library v1.0.0
 * Lightweight, fast, and beautiful datepicker for modern web applications
 * Perfect for travel booking, event planning, and date selection
 *
 * Usage: InfiDate.init({config}) or InfiDate.create(target, config)
 *
 * Features:
 * - Infinite scroll calendar
 * - Single date and date range selection
 * - Mobile-first responsive design
 * - Zero dependencies
 * - Scoped CSS (no conflicts)
 * - Modern ES6+ JavaScript
 * - Travel booking optimized
 *
 * Author: Ankit Semwal
 * License: MIT
 */
!function(t){"use strict";const e={MONTH_NAMES:["January","February","March","April","May","June","July","August","September","October","November","December"],MONTH_NAMES_SHORT:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],DAY_NAMES:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],DAY_NAMES_SHORT:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],iso:function(t){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},fdate:function(t){return t.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})},formatDate:function(t,e){if(!t||!e)return this.fdate(t);const i=t.getFullYear(),n=t.getMonth(),s=t.getDate(),a=t.getDay(),o={YYYY:i,YY:String(i).slice(-2),MMMM:this.MONTH_NAMES[n],MMM:this.MONTH_NAMES_SHORT[n],MM:String(n+1).padStart(2,"0"),M:n+1,DD:String(s).padStart(2,"0"),D:s,dddd:this.DAY_NAMES[a],ddd:this.DAY_NAMES_SHORT[a],dd:this.DAY_NAMES_SHORT[a].slice(0,2)};return e.replace(/YYYY|YY|MMMM|MMM|MM|M|DD|D|dddd|ddd|dd/g,t=>o[t])},parseDate:function(t){if(!t)return null;if(t instanceof Date)return t;if("today"===t)return new Date;if("string"==typeof t){const e=new Date(t);return isNaN(e.getTime())?null:e}return null},isDateDisabled:function(t,e){if(!e||!Array.isArray(e))return!1;for(let i=0;i<e.length;i++){const n=e[i];if("function"==typeof n){if(n(t))return!0}else if("string"==typeof n){if(this.iso(t)===n)return!0}else if(n instanceof Date&&this.iso(t)===this.iso(n))return!0}return!1},addDays:function(t,e){const i=new Date(t);return i.setDate(i.getDate()+e),i},daysDiff:function(t,e){return Math.round((e-t)/864e5)},isSameDay:function(t,e){return!(!t||!e)&&this.iso(t)===this.iso(e)},getFirstDayOfMonth:function(t){return new Date(t.getFullYear(),t.getMonth(),1)},getLastDayOfMonth:function(t){return new Date(t.getFullYear(),t.getMonth()+1,0)},getDaysInMonth:function(t){return this.getLastDayOfMonth(t).getDate()},generateId:function(){return"infidate-"+Math.random().toString(36).substr(2,9)},debounce:function(t,e){let i;return function(...n){clearTimeout(i),i=setTimeout(()=>{clearTimeout(i),t(...n)},e)}},throttle:function(t,e){let i;return function(){const n=arguments,s=this;i||(t.apply(s,n),i=!0,setTimeout(()=>i=!1,e))}}};class i{constructor(t={}){this.config={mode:"single",displayMode:"dropdown",attachTo:null,minDate:null,maxDate:null,disable:[],position:"bottom",closeOnSelect:!0,showBackdrop:!0,title:null,subtitle:null,minRangeDays:1,maxRangeDays:365,allowModeSwitch:!0,defaultToToday:!0,maxMonths:12,initialMonths:8,scrollThreshold:150,onChange:null,onOpen:null,onClose:null,...t},this.isOpen=!1,this.selectedDate=null,this.selectedStartDate=null,this.selectedEndDate=null,this.currentMonth=new Date,this.loadedMonths=[],this.container=null,this.calendar=null,this.attachedElement=null,this.eventListeners=[],this.init()}init(){this.config.attachTo&&(this.attachedElement="string"==typeof this.config.attachTo?document.querySelector(this.config.attachTo):this.config.attachTo),this.createContainer(),this.bindEvents(),"inline"===this.config.displayMode&&this.show(),this.config.defaultToToday&&"single"===this.config.mode&&this.selectDate(new Date)}createContainer(){this.container=document.createElement("div"),this.container.className=`infidate-picker infidate-picker--${this.config.displayMode}`,this.container.id=e.generateId(),"inline"===this.config.displayMode&&this.attachedElement?this.attachedElement.appendChild(this.container):document.body.appendChild(this.container),this.createCalendar()}createCalendar(){const t=`\n        <div class="infidate-calendar">\n          ${"modal"===this.config.displayMode?this.createBackdrop():""}\n          <div class="infidate-content">\n            ${this.createHeader()}\n            <div class="infidate-months-container">\n              <div class="infidate-months" id="${this.container.id}-months"></div>\n            </div>\n          </div>\n        </div>\n      `;this.container.innerHTML=t,this.calendar=this.container.querySelector(".infidate-calendar"),this.monthsContainer=this.container.querySelector(".infidate-months"),this.loadInitialMonths(),this.setupInfiniteScroll()}createBackdrop(){return this.config.showBackdrop?'<div class="infidate-backdrop"></div>':""}createHeader(){return"inline"===this.config.displayMode?`\n          <div class="infidate-header">\n            ${this.config.title?`<h3 class="infidate-title">${this.config.title}</h3>`:""}\n            ${this.config.subtitle?`<p class="infidate-subtitle">${this.config.subtitle}</p>`:""}\n            ${this.config.allowModeSwitch?this.createModeSwitch():""}\n          </div>\n        `:""}createModeSwitch(){return`\n        <div class="infidate-mode-switch">\n          <button type="button" class="infidate-mode-btn ${"single"===this.config.mode?"active":""}" data-mode="single">Single</button>\n          <button type="button" class="infidate-mode-btn ${"range"===this.config.mode?"active":""}" data-mode="range">Range</button>\n        </div>\n      `}loadInitialMonths(){const t=new Date(this.currentMonth);t.setDate(1);for(let e=0;e<this.config.initialMonths;e++){const i=new Date(t);i.setMonth(t.getMonth()+e),this.loadMonth(i)}}loadMonth(t){const e=`${t.getFullYear()}-${t.getMonth()}`;if(this.loadedMonths.includes(e))return;this.loadedMonths.push(e);const i=document.createElement("div");i.className="infidate-month",i.dataset.month=e,i.innerHTML=this.createMonthHTML(t),this.monthsContainer.appendChild(i)}createMonthHTML(t){const i=t.getFullYear(),n=t.getMonth(),s=e.MONTH_NAMES[n],a=new Date(i,n,1),o=new Date(i,n+1,0).getDate(),d=a.getDay();let l=`\n        <div class="infidate-month-header">\n          <h4>${s} ${i}</h4>\n        </div>\n        <div class="infidate-days-header">\n          ${e.DAY_NAMES_SHORT.map(t=>`<div class="infidate-day-name">${t}</div>`).join("")}\n        </div>\n        <div class="infidate-days-grid">\n      `;for(let t=0;t<d;t++)l+='<div class="infidate-day infidate-day--empty"></div>';for(let t=1;t<=o;t++){const s=new Date(i,n,t);l+=`<div class="${["infidate-day",this.isDateDisabled(s)?"infidate-day--disabled":"",this.isDateSelected(s)?"infidate-day--selected":"",e.isSameDay(s,new Date)?"infidate-day--today":"",this.isDateInRange(s)?"infidate-day--in-range":""].filter(Boolean).join(" ")}" data-date="${e.iso(s)}">${t}</div>`}return l+="</div>",l}isDateDisabled(t){if(this.config.minDate){const i=e.parseDate(this.config.minDate);if(i&&t<i)return!0}if(this.config.maxDate){const i=e.parseDate(this.config.maxDate);if(i&&t>i)return!0}return e.isDateDisabled(t,this.config.disable)}isDateSelected(t){return"single"===this.config.mode?this.selectedDate&&e.isSameDay(t,this.selectedDate):this.selectedStartDate&&e.isSameDay(t,this.selectedStartDate)||this.selectedEndDate&&e.isSameDay(t,this.selectedEndDate)}isDateInRange(t){return!("range"!==this.config.mode||!this.selectedStartDate||!this.selectedEndDate)&&(t>this.selectedStartDate&&t<this.selectedEndDate)}setupInfiniteScroll(){const t=e.throttle(()=>{const t=this.monthsContainer,e=t.scrollTop;t.scrollHeight-e-t.clientHeight<this.config.scrollThreshold&&this.loadMoreMonths()},100);this.monthsContainer.addEventListener("scroll",t),this.eventListeners.push({element:this.monthsContainer,event:"scroll",handler:t})}loadMoreMonths(){if(this.loadedMonths.length>=this.config.maxMonths)return;const t=this.loadedMonths[this.loadedMonths.length-1],[e,i]=t.split("-").map(Number),n=new Date(e,i+1,1);this.loadMonth(n)}bindEvents(){const t=t=>{const e=t.target.closest(".infidate-day");if(!e||e.classList.contains("infidate-day--disabled")||e.classList.contains("infidate-day--empty"))return;const i=e.dataset.date;if(i){const t=new Date(i);this.selectDate(t)}};if(this.container.addEventListener("click",t),this.eventListeners.push({element:this.container,event:"click",handler:t}),this.config.allowModeSwitch){const t=t=>{const e=t.target.closest(".infidate-mode-btn");if(e){const t=e.dataset.mode;this.switchMode(t)}};this.container.addEventListener("click",t),this.eventListeners.push({element:this.container,event:"click",handler:t})}"inline"!==this.config.displayMode&&this.bindDropdownModalEvents(),this.bindKeyboardEvents()}bindDropdownModalEvents(){if(this.attachedElement){const t=()=>this.show();this.attachedElement.addEventListener("click",t),this.eventListeners.push({element:this.attachedElement,event:"click",handler:t})}const i=t=>{!this.isOpen||this.container.contains(t.target)||this.attachedElement&&this.attachedElement.contains(t.target)||this.hide()};if(document.addEventListener("click",i),this.eventListeners.push({element:document,event:"click",handler:i}),"modal"===this.config.displayMode){const t=t=>{t.target.classList.contains("infidate-backdrop")&&this.hide()};this.container.addEventListener("click",t),this.eventListeners.push({element:this.container,event:"click",handler:t})}if("dropdown"===this.config.displayMode){const i=e.throttle(()=>{this.isOpen&&this.positionDropdown()},16);t.addEventListener("scroll",i,!0),t.addEventListener("resize",i),this.eventListeners.push({element:t,event:"scroll",handler:i,options:!0},{element:t,event:"resize",handler:i})}}bindKeyboardEvents(){const t=t=>{if(this.isOpen)switch(t.key){case"Escape":t.preventDefault(),this.hide();break;case"Enter":case" ":t.preventDefault();const e=this.container.querySelector(".infidate-day:focus");if(e&&!e.classList.contains("infidate-day--disabled")){const t=e.dataset.date;t&&this.selectDate(new Date(t))}}};document.addEventListener("keydown",t),this.eventListeners.push({element:document,event:"keydown",handler:t})}selectDate(t){this.isDateDisabled(t)||("single"===this.config.mode?(this.selectedDate=t,this.updateDisplay(),this.triggerChange(),this.config.closeOnSelect&&"inline"!==this.config.displayMode&&this.hide()):this.handleRangeSelection(t))}handleRangeSelection(t){if(!this.selectedStartDate||this.selectedStartDate&&this.selectedEndDate)this.selectedStartDate=t,this.selectedEndDate=null;else if(t<this.selectedStartDate)this.selectedStartDate=t,this.selectedEndDate=null;else{this.selectedEndDate=t;const i=e.daysDiff(this.selectedStartDate,this.selectedEndDate);if(i<this.config.minRangeDays-1)return this.selectedStartDate=t,void(this.selectedEndDate=null);if(i>this.config.maxRangeDays-1)return this.selectedStartDate=t,void(this.selectedEndDate=null);this.triggerChange(),this.config.closeOnSelect&&"inline"!==this.config.displayMode&&this.hide()}this.updateDisplay()}updateDisplay(){this.container.querySelectorAll(".infidate-day[data-date]").forEach(t=>{const i=t.dataset.date,n=new Date(i);t.className="infidate-day",this.isDateDisabled(n)&&t.classList.add("infidate-day--disabled"),this.isDateSelected(n)&&t.classList.add("infidate-day--selected"),e.isSameDay(n,new Date)&&t.classList.add("infidate-day--today"),this.isDateInRange(n)&&t.classList.add("infidate-day--in-range")}),this.attachedElement&&"INPUT"===this.attachedElement.tagName&&(this.attachedElement.value=this.getFormattedValue())}getFormattedValue(){if("single"===this.config.mode)return this.selectedDate?e.formatDate(this.selectedDate,"MMM D, YYYY"):"";if(this.selectedStartDate&&this.selectedEndDate){return`${e.formatDate(this.selectedStartDate,"MMM D, YYYY")} to ${e.formatDate(this.selectedEndDate,"MMM D, YYYY")}`}return this.selectedStartDate?e.formatDate(this.selectedStartDate,"MMM D, YYYY"):""}triggerChange(){if(this.config.onChange){const t=this.getChangeData();this.config.onChange(t)}}getChangeData(){if("single"===this.config.mode)return{date:this.selectedDate,formatted:this.selectedDate?e.formatDate(this.selectedDate,"MMM D, YYYY"):null,iso:this.selectedDate?e.iso(this.selectedDate):null};{const t={start:this.selectedStartDate,end:this.selectedEndDate,formatted:this.getFormattedValue()};return this.selectedStartDate&&this.selectedEndDate&&(t.nights=e.daysDiff(this.selectedStartDate,this.selectedEndDate),t.days=t.nights+1),t}}switchMode(t){if(t===this.config.mode)return;this.config.mode=t,this.selectedDate=null,this.selectedStartDate=null,this.selectedEndDate=null;this.container.querySelectorAll(".infidate-mode-btn").forEach(e=>{e.classList.toggle("active",e.dataset.mode===t)}),this.updateDisplay()}show(){this.isOpen||(this.isOpen=!0,this.container.classList.add("infidate-picker--open"),"dropdown"===this.config.displayMode&&this.positionDropdown(),"modal"===this.config.displayMode&&(document.body.style.overflow="hidden"),this.config.onOpen&&this.config.onOpen())}hide(){this.isOpen&&(this.isOpen=!1,this.container.classList.remove("infidate-picker--open"),"modal"===this.config.displayMode&&(document.body.style.overflow=""),this.config.onClose&&this.config.onClose())}positionDropdown(){if(!this.attachedElement||"dropdown"!==this.config.displayMode)return;const e=this.attachedElement.getBoundingClientRect(),i=this.calendar.getBoundingClientRect(),n=t.innerHeight;let s,a;a=e.left;const o=n-e.bottom,d=e.top;s="top"===this.config.position||"auto"===this.config.position&&o<i.height&&d>o?e.top-i.height-2:e.bottom+2,this.calendar.style.position="fixed",this.calendar.style.top=`${s}px`,this.calendar.style.left=`${a}px`,this.calendar.style.zIndex="9999"}destroy(){this.eventListeners.forEach(({element:t,event:e,handler:i,options:n})=>{t.removeEventListener(e,i,n)}),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),"modal"===this.config.displayMode&&this.isOpen&&(document.body.style.overflow=""),this.container=null,this.calendar=null,this.attachedElement=null,this.eventListeners=[]}}const n={version:"1.0.0",defaults:{mode:"single",displayMode:"dropdown",minDate:null,maxDate:null,disable:[],position:"bottom",closeOnSelect:!0,showBackdrop:!0,title:null,subtitle:null,minRangeDays:1,maxRangeDays:365,allowModeSwitch:!0,defaultToToday:!1,maxMonths:12,initialMonths:8,scrollThreshold:150},create:function(t,e={}){const n={...this.defaults,...e};return t&&(n.attachTo=t),new i(n)},singleModal:function(t,e){return this.create(t,{mode:"single",displayMode:"modal",onChange:e})},singleDropdown:function(t,e){return this.create(t,{mode:"single",displayMode:"dropdown",onChange:e})},rangeModal:function(t,e){return this.create(t,{mode:"range",displayMode:"modal",onChange:e})},rangeDropdown:function(t,e){return this.create(t,{mode:"range",displayMode:"dropdown",onChange:e})},openSingleDateModal:function(t,e={}){return this.create(t,{mode:"single",displayMode:"modal",...e})},openSingleDateDropdown:function(t,e={}){return this.create(t,{mode:"single",displayMode:"dropdown",...e})},openRangeDateModal:function(t,e={}){return this.create(t,{mode:"range",displayMode:"modal",...e})},openRangeDateDropdown:function(t,e={}){return this.create(t,{mode:"range",displayMode:"dropdown",...e})},parseDate:e.parseDate,formatDate:e.formatDate,isDateDisabled:e.isDateDisabled,addDays:e.addDays,daysDiff:e.daysDiff,isSameDay:e.isSameDay};void 0!==t&&(t.InfiDate=n,t.InfiDatePicker=i,t.InfiDateUtils=e),"undefined"!=typeof module&&module.exports&&(module.exports={InfiDate:n,InfiDatePicker:i,InfiDateUtils:e}),"function"==typeof define&&define.amd&&define(function(){return{InfiDate:n,InfiDatePicker:i,InfiDateUtils:e}})}("undefined"!=typeof window?window:this);